<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.trasen.tsproject.dao.TbPlanTemplateItemMapper" >
    <delete id="deletePlanItem" parameterType="Integer">
        delete from tb_plan_template_item where temp_id=#{tempId}
    </delete>
    <insert id="saveTemplateItem" parameterType="com.trasen.tsproject.model.TbTemplateItem">
        insert into tb_plan_template_item(temp_id,stage_id,stage_doc_id,role,operator,created) values(#{tempId},#{stageId},#{stageDocId},#{role},#{operator},#{created})
    </insert>
    <select id="selectPlanItem" parameterType="Integer" resultType="com.trasen.tsproject.model.TbPlanTemplateItem">
        SELECT
	te.*, tag.pkid AS checkTagId,
	tag.tag_name AS tagName,
	tag.tag_id AS tagId,
	tag.permission AS permission
    FROM
	tb_plan_template_item te
    LEFT JOIN twf_check_tag tag ON locate(tag.tag_id,te.role)>0  where temp_id = #{tempId}
    </select>
</mapper>